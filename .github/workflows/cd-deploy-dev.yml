name: CD Deploy (Local K8S)

on:
  pull_request_target:
    branches: [deploy/dev]
    types: [closed]

permissions:
  contents: read
  id-token: write

jobs:
  deploy:
    # 只有當 PR 是合併（Merged）狀態時才啟動
    if: github.event.pull_request.merged == true
    uses: royfw/rf-devops/.github/workflows/rfjs-deploy-k8s.yml@main
    with:
      ref: deploy_local
      environment: royfw-dev
      project: rfjs
      namespace: rfjs-dev
    secrets: inherit # 自動傳遞所有的 HARBOR_*, KUBE_CONFIG, ENV_* 等 Secrets
